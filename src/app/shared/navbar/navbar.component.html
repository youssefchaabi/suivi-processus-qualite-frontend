<mat-toolbar color="primary" class="navbar mat-elevation-z4">
  <!-- Logo -->
  <div class="logo-section" (click)="goToDashboard()" tabindex="0" aria-label="Accueil Qualité">
    <mat-icon class="logo-icon">verified</mat-icon>
    <span class="app-title">Suivi Qualité</span>
  </div>

  <span class="spacer"></span>

  <!-- Barre de recherche -->
  <div class="search-container" *ngIf="authService.isLoggedIn()" [class.active]="showSearch">
    <button mat-icon-button class="search-toggle" (click)="toggleSearch()" matTooltip="Rechercher">
      <mat-icon>search</mat-icon>
    </button>
    <div class="search-input-wrapper" *ngIf="showSearch">
      <mat-form-field appearance="outline" class="search-field">
        <input matInput 
               [(ngModel)]="searchQuery" 
               placeholder="Rechercher..."
               (keyup.enter)="onSearch()"
               autocomplete="off">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>
  </div>

  <!-- Actions rapides -->
  <ng-container *ngIf="authService.isLoggedIn()">
    <!-- Dashboard -->
    <button mat-icon-button 
            (click)="goToDashboard()" 
            matTooltip="Dashboard" 
            class="action-btn">
      <mat-icon>dashboard</mat-icon>
    </button>

    <!-- Notifications -->
    <button mat-icon-button 
            class="action-btn notif-btn" 
            matTooltip="Notifications" 
            (click)="goToNotifications()">
      <mat-icon [matBadge]="notificationCount" 
                [matBadgeHidden]="notificationCount === 0"
                matBadgeColor="warn"
                matBadgeSize="small">notifications</mat-icon>
    </button>

    <!-- Aide -->
    <button mat-icon-button 
            matTooltip="Aide" 
            class="action-btn">
      <mat-icon>help_outline</mat-icon>
    </button>

    <!-- Paramètres -->
    <button mat-icon-button 
            matTooltip="Paramètres" 
            class="action-btn">
      <mat-icon>settings</mat-icon>
    </button>
  </ng-container>

  <!-- Menu utilisateur -->
  <ng-container *ngIf="authService.isLoggedIn()">
    <button mat-button 
            [matMenuTriggerFor]="userMenu" 
            class="user-menu-btn"
            aria-label="Menu utilisateur">
      <mat-icon class="user-icon">account_circle</mat-icon>
      <span class="user-name">{{ getUserName() }}</span>
      <mat-icon class="dropdown-icon">arrow_drop_down</mat-icon>
    </button>
    <mat-menu #userMenu="matMenu" class="user-menu">
      <div class="user-menu-header">
        <mat-icon class="header-icon">person</mat-icon>
        <div class="user-info">
          <div class="user-name-text">{{ getUserName() }}</div>
          <div class="user-role">{{ getRoleLabel() }}</div>
        </div>
      </div>
      <mat-divider></mat-divider>
      <button mat-menu-item (click)="goToDashboard()">
        <mat-icon>dashboard</mat-icon>
        <span>Mon Dashboard</span>
      </button>
      <button mat-menu-item>
        <mat-icon>person</mat-icon>
        <span>Mon Profil</span>
      </button>
      <button mat-menu-item>
        <mat-icon>settings</mat-icon>
        <span>Paramètres</span>
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item (click)="logout()" class="logout-btn">
        <mat-icon>logout</mat-icon>
        <span>Déconnexion</span>
      </button>
    </mat-menu>
  </ng-container>
</mat-toolbar>
